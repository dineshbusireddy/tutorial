<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>API Gateway Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 700px; margin: 2rem auto; padding: 1rem; }
    .question-container { border: 1px solid #ddd; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; }
    .options { margin-top: 0.5rem; list-style-type: none; padding: 0; }
    .options li {
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 0.5rem;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }
    .options li.correct {
      background-color: #d4edda;
      border-color: #28a745;
      color: #155724;
      font-weight: bold;
    }
    .options li.incorrect {
      background-color: #f8d7da;
      border-color: #dc3545;
      color: #721c24;
      font-weight: bold;
    }
    .options li.disabled {
      cursor: default;
      opacity: 0.7;
    }
    button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background-color: #007bff;
      color: white;
    }
    button:disabled {
      background-color: #6c757d;
      cursor: not-allowed;
    }
    .explanation {
      background: #f9f9f9;
      border: 1px solid #ccc;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 6px;
      font-style: italic;
    }
    .nav-buttons {
      margin-top: 2rem;
      text-align: center;
    }
    .nav-buttons button {
      margin: 0 10px;
      min-width: 120px;
    }
    .scoreboard {
      text-align: center;
      font-size: 1.4rem;
      font-weight: bold;
      margin-top: 3rem;
      padding: 2rem;
      border: 2px solid #007bff;
      border-radius: 12px;
      background-color: #e9f5ff;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 0 15px rgba(0,123,255,0.3);
    }
    .icon {
      font-weight: bold;
      margin-left: 10px;
      font-size: 1.2em;
      vertical-align: middle;
    }
    .icon.correct {
      color: #28a745;
    }
    .icon.incorrect {
      color: #dc3545;
    }
  </style>
</head>
<body>

  <div id="question-page" class="question-container">
    <!-- Question content will be injected here -->
  </div>

  <div class="nav-buttons">
    <button id="prev-btn" disabled>Previous Question</button>
    <button id="next-btn" disabled>Next Question</button>
  </div>

  <div id="scoreboard" class="scoreboard" style="display:none;">
    <!-- Final score display -->
  </div>

  <!-- jQuery CDN -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <script>
    $(function() {
      const questions = [
		  {
			"Q_No": "1",
			"Question": "To make a Serverless API, you should integrate API Gateway with .........................",
			"A": "Amazon EC2",
			"B": "Elastic Load Balancer",
			"C": "AWS Lambda",
			"D": "",
			"E": "",
			"Answer": "C",
			"Explanation": "API Gateway integrates with AWS Lambda for serverless APIs."
		  },
		  {
			"Q_No": "2",
			"Question": "To redirect your API Gateway stage to the correct AWS Lambda Alias, you should use .........................",
			"A": "Canary Deployment",
			"B": "Stage Variables",
			"C": "X-Ray Integration",
			"D": "HTTP Endpoint",
			"E": "",
			"Answer": "B",
			"Explanation": "Stage Variables let API Gateway route to different Lambda Aliases."
		  },
		  {
			"Q_No": "3",
			"Question": "You can integrate API Gateway with the following, EXCEPT .........................",
			"A": "Lambda Functions",
			"B": "HTTP Endpoints",
			"C": "AWS Services",
			"D": "AWS CloudShell",
			"E": "",
			"Answer": "D",
			"Explanation": "API Gateway does not integrate with AWS CloudShell."
		  },
		  {
			"Q_No": "4",
			"Question": "You have created a whole new API (v2) and you want to test it, but you're worried about shifting all the traffic to it. What is the recommended way to test it?",
			"A": "Create a whole new Stage, then use Route 53 to distribute traffic between your two Stages using a Weighted record (CNAME)",
			"B": "Create a Canary release",
			"C": "Update all your Lambda functions to use Aliases",
			"D": "",
			"E": "",
			"Answer": "B",
			"Explanation": "Canary release lets you test a new version by shifting a portion of traffic"
		  },
		  {
			"Q_No": "5",
			"Question": "You have an API Gateway backed by a set of Lambda functions and want to mask some fields in the output data. What should you use?",
			"A": "Mapping Templates",
			"B": "Custom Authorizer",
			"C": "Cognito Mask",
			"D": "",
			"E": "",
			"Answer": "A",
			"Explanation": "Mapping Templates enable output transformation and masking fields in API Gateway."
		  },
		  {
			"Q_No": "6",
			"Question": "Which specification allows you to import/export your API as code?",
			"A": "gRPC",
			"B": "SOAP",
			"C": "Swagger / OpenAPI",
			"D": "",
			"E": "",
			"Answer": "C",
			"Explanation": "Swagger / OpenAPI is the standard for defining APIs as code and for import/export."
		  },
		  {
			"Q_No": "7",
			"Question": "Your Lambda-backed API is overloaded and costly. The response is the same all day. What should you do?",
			"A": "Enable mock responses",
			"B": "Integrate API Gateway with ElastiCache",
			"C": "Enable Caching for your Stage",
			"D": "",
			"E": "",
			"Answer": "C",
			"Explanation": "Enabling caching at the stage reduces invocations and billing for repeatable responses."
		  },
		  {
			"Q_No": "8",
			"Question": "API Gateway Caching is defined per ..................... with the default TTL ....................",
			"A": "API, 300 seconds",
			"B": "Stage, 300 seconds",
			"C": "API, 600 seconds",
			"D": "Stage, 600 seconds",
			"E": "",
			"Answer": "B",
			"Explanation": "Caching is stage-specific and the default TTL is 300 seconds."
		  },
		  {
			"Q_No": "9",
			"Question": "How can clients invalidate the cache of an API from the client-side?",
			"A": "Using Stage Variables",
			"B": "Pass an URL parameter InvalidateCache",
			"C": "Pass the HTTP header Cache-Control: max-age=0",
			"D": "",
			"E": "",
			"Answer": "C",
			"Explanation": "Sending \"Cache-Control: max-age=0\" header from the client invalidates the API cache."
		  },
		  {
			"Q_No": "10",
			"Question": "Which API Gateway feature allows you to implement pricing plans for different customers?",
			"A": "CORS",
			"B": "Usage Plans & API Keys",
			"C": "Lambda Authorizers",
			"D": "Deployment Stages",
			"E": "",
			"Answer": "B",
			"Explanation": "Usage Plans & API Keys allow you to manage and limit usage for different customers."
		  },
		  {
			"Q_No": "11",
			"Question": "You want to troubleshoot a serverless app with API Gateway, Lambda, DynamoDB, and slow/exceptions occur. What should you use?",
			"A": "CloudWatch Logs",
			"B": "CloudWatch Detailed Metrics",
			"C": "X-Ray",
			"D": "",
			"E": "",
			"Answer": "C",
			"Explanation": "X-Ray visualizes and traces API Gateway, Lambda, and DynamoDB interactions for troubleshooting."
		  },
		  {
			"Q_No": "12",
			"Question": "How do you support usage by users from multiple domains for your API?",
			"A": "Deploy a new Stage for each user",
			"B": "Enable CORS",
			"C": "Create a Stage Variable for each user",
			"D": "",
			"E": "",
			"Answer": "B",
			"Explanation": "CORS enables cross-domain access for APIs consumed from multiple domains."
		  },
		  {
			"Q_No": "13",
			"Question": "You want to authenticate requests made to your API. All requests contain a Bearer token in the Authorization header. These tokens must be validated against a 3rd party provider. What should you use?",
			"A": "IAM Roles with API Gateway",
			"B": "API Gateway Lambda Authorizer",
			"C": "Cognito User Pools with API Gateway",
			"D": "",
			"E": "",
			"Answer": "B",
			"Explanation": "Use Lambda Authorizer to validate tokens from an external/3rd party provider."
		  },
		  {
			"Q_No": "14",
			"Question": "You want to authenticate users against Facebook before requests to your API hosted by API Gateway. What should you use for seamless integration?",
			"A": "Cognito Sync",
			"B": "DynamoDB Table with Lambda Authorizer",
			"C": "Cognito User Pools",
			"D": "Cognito Federated Identity Pools",
			"E": "",
			"Answer": "C",
			"Explanation": "Cognito User Pools integrate with social identity providers for authentication."
		  },
		  {
			"Q_No": "15",
			"Question": "Which HTTP error code does API Gateway return when there are too many requests?",
			"A": "400",
			"B": "403",
			"C": "429",
			"D": "502",
			"E": "",
			"Answer": "C",
			"Explanation": "429 Too Many Requests is returned for rate limiting or throttling in API Gateway."
		  },
		  {
			"Q_No": "16",
			"Question": "Which CloudWatch metric helps analyze timeout issues between API Gateway and a Lambda function?",
			"A": "CacheHitCount",
			"B": "IntegrationLatency",
			"C": "CacheMissCount",
			"D": "Count",
			"E": "",
			"Answer": "B",
			"Explanation": "IntegrationLatency shows time API Gateway spends waiting on integrations like Lambda."
		  },
		  {
			"Q_No": "17",
			"Question": "API Gateway supports the WebSocket protocol for real-time APIs.",
			"A": "True",
			"B": "False",
			"C": "",
			"D": "",
			"E": "",
			"Answer": "A",
			"Explanation": "API Gateway supports WebSocket protocol for building real-time APIs."
		  }
		];

      let currentIndex = 0;
      let wrongCount = 0;
      let answeredQuestions = new Array(questions.length).fill(false);

      const $questionPage = $('#question-page');
      const $prevBtn = $('#prev-btn');
      const $nextBtn = $('#next-btn');
      const $scoreboard = $('#scoreboard');

      function escapeHtml(text) {
        return $('<div>').text(text).html();
      }

      function renderQuestion(index) {
        let q = questions[index];
        if (!q) {
          $questionPage.html('<p>No question found.</p>');
          return;
        }

        // Hide scoreboard if showing
        $scoreboard.hide().html('');
        $questionPage.show();

        const optionsKeys = ['A', 'B', 'C', 'D', 'E'];
        let optionsHtml = '<ul class="options">';
        optionsKeys.forEach(key => {
          if (q[key] && q[key].trim() !== '') {
            optionsHtml += `<li data-option="${key}"><strong>${key}.</strong> ${escapeHtml(q[key])} <span class="icon"></span></li>`;
          }
        });
        optionsHtml += '</ul>';

        $questionPage.html(`
          <h2>Question ${q.Q_No}</h2>
          <p>${escapeHtml(q.Question)}</p>
          ${optionsHtml}
          <div id="explanation" class="explanation" style="display:none;"></div>
        `);

        const $options = $questionPage.find('.options li');
        $options.removeClass('correct incorrect disabled')
                .css('pointer-events', 'auto')
                .find('.icon').text('').removeClass('correct incorrect');

        // Next button disabled until answer selected
        $nextBtn.prop('disabled', true);

        // Previous button show/hide and enable/disable
        if (index === 0) {
          $prevBtn.hide();
        } else {
          $prevBtn.show().prop('disabled', false);
        }

        // Next button text changes on last question
        if (index === questions.length - 1) {
          $nextBtn.text('Show Results');
        } else {
          $nextBtn.text('Next Question');
        }

        if (answeredQuestions[index]) {
          // Disable options and show answer + explanation, enable next
          showAnswerHighlight(q);
          $nextBtn.prop('disabled', false);
        } else {
          // Attach click handler for options
          $options.off('click').on('click', function() {
            handleAnswerSelection($(this), q);
          });
        }
      }

      function handleAnswerSelection($selectedLi, question) {
        let selectedOption = $selectedLi.data('option');

        if (answeredQuestions[currentIndex]) return;

        const $options = $questionPage.find('.options li');

        // Disable all options after selection
        $options.addClass('disabled').css('pointer-events', 'none');

        answeredQuestions[currentIndex] = true;

        const $explanation = $('#explanation');
        $explanation.show();

        if (selectedOption === question.Answer) {
          $selectedLi.addClass('correct');
          $selectedLi.find('.icon').text('✓').addClass('correct');
          $explanation.html('<strong>Correct!</strong> ' + escapeHtml(question.Explanation));
        } else {
          $selectedLi.addClass('incorrect');
          $selectedLi.find('.icon').text('✗').addClass('incorrect');

          // Highlight correct answer
          $options.each(function() {
            if ($(this).data('option') === question.Answer) {
              $(this).addClass('correct');
              $(this).find('.icon').text('✓').addClass('correct');
            }
          });

          $explanation.html('<strong>Incorrect.</strong> ' + escapeHtml(question.Explanation));
          wrongCount++;
        }

        // Enable Next button after answer selection
        $nextBtn.prop('disabled', false);
      }

      function showAnswerHighlight(question) {
        const $options = $questionPage.find('.options li');
        const $explanation = $('#explanation');
        $explanation.show();
        $explanation.html('<strong>Explanation:</strong> ' + escapeHtml(question.Explanation));

        $options.addClass('disabled').css('pointer-events', 'none');

        $options.each(function() {
          if ($(this).data('option') === question.Answer) {
            $(this).addClass('correct');
            $(this).find('.icon').text('✓').addClass('correct');
          }
        });
      }

      $prevBtn.click(function() {
        if (currentIndex > 0) {
          currentIndex--;
          renderQuestion(currentIndex);
        }
      });

      $nextBtn.click(function() {
        if (currentIndex < questions.length - 1) {
          currentIndex++;
          renderQuestion(currentIndex);
        } else {
          showFinalScore();
        }
      });

      function showFinalScore() {
        $questionPage.hide();
        $prevBtn.hide();
        $nextBtn.hide();

        const totalQuestions = questions.length;
        const correctCount = totalQuestions - wrongCount;

        $scoreboard.html(`
          <p>Your Score: <strong>${correctCount} / ${totalQuestions}</strong></p>
          <p>Wrong Answers: <strong>${wrongCount}</strong></p>
          <button id="restart-btn">Restart Quiz</button>
        `).show();

        $('#restart-btn').click(function() {
          currentIndex = 0;
          wrongCount = 0;
          answeredQuestions.fill(false);
          $prevBtn.show().prop('disabled', true);
          $nextBtn.show().prop('disabled', true);
          $scoreboard.hide();
          renderQuestion(currentIndex);
        });
      }

      // Initial render
      renderQuestion(currentIndex);
    });
  </script>

</body>
</html>
