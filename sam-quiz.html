<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SAM Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 700px; margin: 2rem auto; padding: 1rem; }
    .question-container { border: 1px solid #ddd; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; }
    .options { margin-top: 0.5rem; list-style-type: none; padding: 0; }
    .options li {
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 0.5rem;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }
    .options li.correct {
      background-color: #d4edda;
      border-color: #28a745;
      color: #155724;
      font-weight: bold;
    }
    .options li.incorrect {
      background-color: #f8d7da;
      border-color: #dc3545;
      color: #721c24;
      font-weight: bold;
    }
    .options li.disabled {
      cursor: default;
      opacity: 0.7;
    }
    button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background-color: #007bff;
      color: white;
    }
    button:disabled {
      background-color: #6c757d;
      cursor: not-allowed;
    }
    .explanation {
      background: #f9f9f9;
      border: 1px solid #ccc;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 6px;
      font-style: italic;
    }
    .nav-buttons {
      margin-top: 2rem;
      text-align: center;
    }
    .nav-buttons button {
      margin: 0 10px;
      min-width: 120px;
    }
    .scoreboard {
      text-align: center;
      font-size: 1.4rem;
      font-weight: bold;
      margin-top: 3rem;
      padding: 2rem;
      border: 2px solid #007bff;
      border-radius: 12px;
      background-color: #e9f5ff;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 0 15px rgba(0,123,255,0.3);
    }
    .icon {
      font-weight: bold;
      margin-left: 10px;
      font-size: 1.2em;
      vertical-align: middle;
    }
    .icon.correct {
      color: #28a745;
    }
    .icon.incorrect {
      color: #dc3545;
    }
  </style>
</head>
<body>

  <div id="question-page" class="question-container">
    <!-- Question content will be injected here -->
  </div>

  <div class="nav-buttons">
    <button id="prev-btn" disabled>Previous Question</button>
    <button id="next-btn" disabled>Next Question</button>
  </div>

  <div id="scoreboard" class="scoreboard" style="display:none;">
    <!-- Final score display -->
  </div>

  <!-- jQuery CDN -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <script>
    $(function() {
      const questions = [
	  {
		"Q_No": "1",
		"Question": "Which of the following commands allows you to upload your Serverless SAM application to AWS?",
		"A": "sam deploy",
		"B": "sam zip",
		"C": "sam upload",
		"D": "sam package",
		"E": "",
		"Answer": "A",
		"Explanation": "The sam deploy command uploads and deploys SAM apps to AWS."
	  },
	  {
		"Q_No": "2",
		"Question": "You see Transform: 'AWS::Serverless-2016-10-31' in a CloudFormation template. What does this represent?",
		"A": "It's an Intrinsic function",
		"B": "It's a Lambda function definition",
		"C": "It's a SAM template",
		"D": "",
		"E": "",
		"Answer": "C",
		"Explanation": "'AWS::Serverless-2016-10-31' indicates a SAM template, used to define serverless resources."
	  },
	  {
		"Q_No": "3",
		"Question": "AWS SAM supports the following resource types, EXCEPT .................................",
		"A": "AWS::Serverless::Function",
		"B": "AWS::Serverless::UserPool",
		"C": "AWS::Serverless::Api",
		"D": "AWS::Serverless::SimpleTable",
		"E": "",
		"Answer": "B",
		"Explanation": "AWS::Serverless::UserPool resource is not supported by AWS SAM."
	  },
	  {
		"Q_No": "4",
		"Question": "Which SAM Policy Template do you use in a SAM template to give a Lambda function read access to objects in S3 buckets?",
		"A": "SQSPollerPolicy",
		"B": "S3CrudPolicy",
		"C": "S3ReadPolicy",
		"D": "LambdaInvokePolicy",
		"E": "",
		"Answer": "C",
		"Explanation": "The S3ReadPolicy SAM policy gives Lambda functions read-only access to S3 buckets."
	  },
	  {
		"Q_No": "5",
		"Question": "........................ allows you to debug your Lambda functions locally, inspect variables, and execute code line-by-line.",
		"A": "SAM CLI only",
		"B": "AWS Toolkits only",
		"C": "SAM CLI + AWS Toolkits",
		"D": "",
		"E": "",
		"Answer": "C",
		"Explanation": "SAM CLI + AWS Toolkits let you debug Lambda functions locally with advanced features."
	  }
	];

      let currentIndex = 0;
      let wrongCount = 0;
      let answeredQuestions = new Array(questions.length).fill(false);

      const $questionPage = $('#question-page');
      const $prevBtn = $('#prev-btn');
      const $nextBtn = $('#next-btn');
      const $scoreboard = $('#scoreboard');

      function escapeHtml(text) {
        return $('<div>').text(text).html();
      }

      function renderQuestion(index) {
        let q = questions[index];
        if (!q) {
          $questionPage.html('<p>No question found.</p>');
          return;
        }

        // Hide scoreboard if showing
        $scoreboard.hide().html('');
        $questionPage.show();

        const optionsKeys = ['A', 'B', 'C', 'D', 'E'];
        let optionsHtml = '<ul class="options">';
        optionsKeys.forEach(key => {
          if (q[key] && q[key].trim() !== '') {
            optionsHtml += `<li data-option="${key}"><strong>${key}.</strong> ${escapeHtml(q[key])} <span class="icon"></span></li>`;
          }
        });
        optionsHtml += '</ul>';

        $questionPage.html(`
          <h2>Question ${q.Q_No}</h2>
          <p>${escapeHtml(q.Question)}</p>
          ${optionsHtml}
          <div id="explanation" class="explanation" style="display:none;"></div>
        `);

        const $options = $questionPage.find('.options li');
        $options.removeClass('correct incorrect disabled')
                .css('pointer-events', 'auto')
                .find('.icon').text('').removeClass('correct incorrect');

        // Next button disabled until answer selected
        $nextBtn.prop('disabled', true);

        // Previous button show/hide and enable/disable
        if (index === 0) {
          $prevBtn.hide();
        } else {
          $prevBtn.show().prop('disabled', false);
        }

        // Next button text changes on last question
        if (index === questions.length - 1) {
          $nextBtn.text('Show Results');
        } else {
          $nextBtn.text('Next Question');
        }

        if (answeredQuestions[index]) {
          // Disable options and show answer + explanation, enable next
          showAnswerHighlight(q);
          $nextBtn.prop('disabled', false);
        } else {
          // Attach click handler for options
          $options.off('click').on('click', function() {
            handleAnswerSelection($(this), q);
          });
        }
      }

      function handleAnswerSelection($selectedLi, question) {
        let selectedOption = $selectedLi.data('option');

        if (answeredQuestions[currentIndex]) return;

        const $options = $questionPage.find('.options li');

        // Disable all options after selection
        $options.addClass('disabled').css('pointer-events', 'none');

        answeredQuestions[currentIndex] = true;

        const $explanation = $('#explanation');
        $explanation.show();

        if (selectedOption === question.Answer) {
          $selectedLi.addClass('correct');
          $selectedLi.find('.icon').text('✓').addClass('correct');
          $explanation.html('<strong>Correct!</strong> ' + escapeHtml(question.Explanation));
        } else {
          $selectedLi.addClass('incorrect');
          $selectedLi.find('.icon').text('✗').addClass('incorrect');

          // Highlight correct answer
          $options.each(function() {
            if ($(this).data('option') === question.Answer) {
              $(this).addClass('correct');
              $(this).find('.icon').text('✓').addClass('correct');
            }
          });

          $explanation.html('<strong>Incorrect.</strong> ' + escapeHtml(question.Explanation));
          wrongCount++;
        }

        // Enable Next button after answer selection
        $nextBtn.prop('disabled', false);
      }

      function showAnswerHighlight(question) {
        const $options = $questionPage.find('.options li');
        const $explanation = $('#explanation');
        $explanation.show();
        $explanation.html('<strong>Explanation:</strong> ' + escapeHtml(question.Explanation));

        $options.addClass('disabled').css('pointer-events', 'none');

        $options.each(function() {
          if ($(this).data('option') === question.Answer) {
            $(this).addClass('correct');
            $(this).find('.icon').text('✓').addClass('correct');
          }
        });
      }

      $prevBtn.click(function() {
        if (currentIndex > 0) {
          currentIndex--;
          renderQuestion(currentIndex);
        }
      });

      $nextBtn.click(function() {
        if (currentIndex < questions.length - 1) {
          currentIndex++;
          renderQuestion(currentIndex);
        } else {
          showFinalScore();
        }
      });

      function showFinalScore() {
        $questionPage.hide();
        $prevBtn.hide();
        $nextBtn.hide();

        const totalQuestions = questions.length;
        const correctCount = totalQuestions - wrongCount;

        $scoreboard.html(`
          <p>Your Score: <strong>${correctCount} / ${totalQuestions}</strong></p>
          <p>Wrong Answers: <strong>${wrongCount}</strong></p>
          <button id="restart-btn">Restart Quiz</button>
        `).show();

        $('#restart-btn').click(function() {
          currentIndex = 0;
          wrongCount = 0;
          answeredQuestions.fill(false);
          $prevBtn.show().prop('disabled', true);
          $nextBtn.show().prop('disabled', true);
          $scoreboard.hide();
          renderQuestion(currentIndex);
        });
      }

      // Initial render
      renderQuestion(currentIndex);
    });
  </script>

</body>
</html>
